/*
* Kendo UI v2012.1.124 (http://kendoui.com)
* Copyright 2012 Telerik AD. All rights reserved.
*
* Kendo UI commercial licenses may be obtained at http://kendoui.com/license.
* If you do not own a commercial license, this file shall be governed by the
* GNU General Public License (GPL) version 3. For GPL requirements, please
* review: http://www.gnu.org/copyleft/gpl.html
*/

(function(a,b){function E(){return Math.abs(window.orientation)/90?"km-horizontal":"km-vertical"}function D(b){B(a(b.currentTarget))&&b.preventDefault()}function C(b){var c=a(b.currentTarget),d=c.attr("href");!b.isDefaultPrevented()&&B(c)&&(d&&(c.attr("href","#!"),setTimeout(function(){c.attr("href",d)}),e.navigate(d)),b.preventDefault())}function B(a){return a.data(c.ns+"rel")!="external"}function A(b){h.appMode||(h.android&&a(window).scroll(function(){b.height(window.innerHeight)}),a(window).load(a.proxy(z,b)),a(window).bind(p,a.proxy(z,b)))}function z(b){var c=0,d,e=window.orientation+"";if(v!=e){b=a(this),n[e]||(n[e]=a(window).height());if(h.device=="iphone"||h.device=="ipod"||h.android)h.android?c=56:c=60,d=n[e]+c,d!=b.height()&&(b.height(d),setTimeout(function(){window.scrollTo(0,1)},0));v=e}}function y(a){/<body[^>]*>(([\u000a\u000d\u2028\u2029]|.)*)<\/body>/i.test(a)&&(a=RegExp.$1),i[0].innerHTML=a;return i}function x(a){return a.replace(/(\S+)/g,"["+g("role")+"*=$1],")}var c=window.kendo,d=c.mobile,e=c.history,f=c.support,g=c.attr,h=f.mobileOS,i=a("<div/>"),j='<meta name="apple-mobile-web-app-capable" content="yes" /> \n                <meta name="apple-mobile-web-app-status-bar-style" content="black" /> \n                <meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" name="viewport" />',k=c.template('<link rel="apple-touch-icon" href="${icon}" />'),l=x("button listview-link"),m=x("tab"),n={},o=f.transitions.css+"transform",p="onorientationchange"in window?"orientationchange":"resize",q=d.View,r=d.ViewSwitcher,s=d.Layout,t="viewInit",u="viewShow",v=-1,w=c.roleSelector,F=c.Observable.extend({init:function(b,d){var e=this;e.options=d||{},e.layouts={},c.Observable.fn.init.call(e,e.options),e.element=b?a(b):a(document.body),e.bind([t,u],e.options),a(function(){A(e.element),e._attachOrientationChange(),e._attachMeta(),e._setupAppLinks(),e._setupLayouts(e.element),e._startHistory()})},navigate:function(a){var b=this;b._findView(a,function(c){e.navigate(a,!0),b.trigger("viewHide",{view:b.view}),(new r(b)).replace(b.view,c),b._setCurrentView(c)})},scroller:function(){return this.view.content.data("kendoScroller")},_setupAppLinks:function(){this.element.delegate(m,f.mousedown,C).delegate(l,f.mouseup,C).delegate(m+l,"click",D)},_setupLayouts:function(b){var d=this;b.find(c.roleSelector("layout")).each(function(){var b=a(this);d.layouts[b.data("id")]=new s(b)})},_startHistory:function(){var b=this,c,d;c=b.element.find(w("view")),c.first().attr(g("url"),"/"),d={change:function(a){b.navigate(a.string)},ready:function(a){b._findView(a.string,function(a){c.not(a.element).hide(),a.onShowStart(),b._setCurrentView(a)})}},e.start(a.extend(b.options,d))},_setCurrentView:function(a){var b=this,c=e.url().params;b.view=a,a.params=c,b.trigger(u,{view:a,params:c})},_createView:function(a){var b=this,c=b.dataOrDefault(a,"layout");c&&(c=b.layouts[c]);var d=new q(a,{layout:c});b.trigger(t,{view:d});return d},_createRemoteView:function(b,c){var d=this,e=a(y(c)),f=e.find(w("view")).hide(),h=e.find(w("layout")),i=e.find("script, style"),j=f.first(),k;j.hide().attr(g("url"),b),d._setupLayouts(e),d.element.append(h),d.element.append(i),d.element.append(f),k=d._createView(j);return k},_findView:function(b,c){var d=this,e,f=b.charAt(0),h=f==="#",i=f==="/",j;j=d.element.find("["+g("url")+"='"+b+"']"),!j[0]&&!i&&(j=d.element.find(h?b:"#"+b)),e=j.data("kendoView"),e?c(e):j[0]?c(d._createView(j)):a.get(b,function(a){c(d._createRemoteView(b,a))})},_attachOrientationChange:function(){var b=this,c=b.element;c.parent().addClass("km-root"),c.addClass("km-"+(h?h.name:"ios")+" "+E()),a(window).bind(p,function(b){c.removeClass("km-horizontal km-vertical").addClass(E()),a(".km-scroll-container:visible").css(o,"none")})},_attachMeta:function(){var b=this.options.icon;a("head").prepend(j),b&&a("head").prepend(k({icon:b}))},dataOrDefault:function(a,b){return typeof a.data(c.ns+b)!="undefined"?a.data(b):this.options[b]}});c.mobile.Application=F})(jQuery)