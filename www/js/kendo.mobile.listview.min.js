/*
* Kendo UI v2012.1.124 (http://kendoui.com)
* Copyright 2012 Telerik AD. All rights reserved.
*
* Kendo UI commercial licenses may be obtained at http://kendoui.com/license.
* If you do not own a commercial license, this file shall be governed by the
* GNU General Public License (GPL) version 3. For GPL requirements, please
* review: http://www.gnu.org/copyleft/gpl.html
*/

(function(a,b){function p(b,d){d=a(d);var e=d.parent();if(!e.contents().not(d)[0]){var f=e.data(c.ns+"icon"),g=a('<span class="km-icon"/>');d.addClass("km-listview-link").attr(c.attr("role"),"listview-link"),f&&(d.prepend(g),g.addClass("km-"+f))}}function o(b){var d=a(b.currentTarget);clickedLink=a(b.target).closest("a"),role=clickedLink.data(c.ns+"role")||"",clickedLink[0]&&!role.match(/button/)&&d.toggleClass("km-state-active",b.type===l)}var c=window.kendo,d=c.mobile.ui,e=c.support,f=c.data.DataSource,g=d.Widget,h=".km-list > li",i=a.proxy,j=c.template('<li><div class="km-group-title">#= this.headerTemplate(data) #</div><ul>#= kendo.render(this.template, data.items)#</ul></li>'),k="function",l=e.mousedown,m=e.mouseup,n="click",q=g.extend({init:function(b,c){var d=this;g.fn.init.call(d,b,c),c=d.options,d.element.delegate(h,l+" "+m,o).delegate(h,m,i(d._click,d)),c.dataSource?(d.dataSource=f.create(c.dataSource).bind("change",a.proxy(d._refresh,d)),d._template(),d.dataSource.fetch()):d._style(),d.bind([n],c)},options:{name:"ListView",type:"flat",template:"${data}",headerTemplate:"${value}",style:""},_refresh:function(){var a=this,b=a.dataSource,d,e=b.view();b.group()[0]?(a.options.type="group",a.element.html(c.render(a.groupTemplate,e))):a.element.html(c.render(a.template,e)),c.mobile.enhance(a.element.children()),a._style()},_template:function(){var b=this,d=b.options.template,e=b.options.headerTemplate,f=b.dataSource.options.schema.model,g="",h={},i={};f&&(g=' data-uid="#=uid#"'),typeof d===k&&(h.template=d,d="#=this.template(data)#"),i.template=b.template=a.proxy(c.template("<li"+g+">"+d+"</li>"),h),typeof e===k&&(i._headerTemplate=e,e="#=this._headerTemplate(data)#"),i.headerTemplate=c.template(e),b.groupTemplate=a.proxy(j,i)},_click:function(b){var d=this,e,f=a(b.currentTarget),g=a(b.target),h=g.closest("["+c.attr("name")+"]",f),i=h.data(c.ns+"name"),j=f.attr(c.attr("uid"));j&&(e=d.dataSource.getByUid(j)),d.trigger(n,{target:g,item:f,dataItem:e,buttonName:i,button:h.data("kendoMobileButton")})&&b.preventDefault()},_style:function(){var a=this,b=a.options,d=b.type==="group",e=b.style==="inset";a.element.addClass("km-listview").toggleClass("km-list",!d).toggleClass("km-listinset",!d&&e).toggleClass("km-listgroup",d&&!e).toggleClass("km-listgroupinset",d&&e).find("a:only-child:not([data-"+c.ns+"role])").each(p),d&&a.element.children().children("ul").addClass("km-list"),a.element.closest(".km-content").toggleClass("km-insetcontent",e)}});d.plugin(q)})(jQuery)